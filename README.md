# Движок для новогодней олимпиады ЛКШ 2022.Зима
В ЛКШ 2022.Зима новогодняя олимпиада по программированию была проведена в необычном формате. Команды из 5-6 человек получали доступ к полю из задач-шестиугольников:

Решив задачу, участники получают возможность прочитать условия задач вокруг решённой.

За неправильные попытки начисляется штраф. Штраф не может превышать 70% исходной стоимости задачи (но это настраивается).

# Где что лежит

В папке `src` — обычное джанго-приложение. Настройки лежат в `src/olymp/settings.py`. Важные настройки — в конце этого файла. 
Там можно указать путь до еджаждевского `serve.cfg`, токен для телеграм-бота и идентификатор телеграм-чата. В этот чат будут приходит оповещения о том, что кто-то взял бонус.

Запускать на сервере любым доступным и привычным для джанго-приложений способом. Например, в связке с `nginx` и `uwsgi`.

# Развёртывание
1. Необходимо распаковать polygon-архив контеста в init/polygon-contest
2. Добавить в init/files-russian все условия задач, назвав их в соответствии
с названием задачи в polygon
3. Задать конфигурацию поля в init/init.txt. Для осознания формата смотри init.py,
    генерирующий по данному файлу django объекты.
4. Заменить serve.cfg на конфиг контеста из ejudge
5. Изменить в src/olymp/settings.py адрес до базы данных ejudge и
id контеста. 
6. При необходимости сменить порт, по которому будет доступен frontend в Dockerfile.
По умолчанию: 5556.
7. Запустить ./update.sh указав имя докера, под которым он зальётся на dockerhub
например ./update.sh khaser/sis-2022-winter
8. Развернуть докер в удобном вам месте, в котором будет доступ к базе данных
ejudge. 

**Предупреждение: сервер внутри docker крутиться в debug mode, при ошибке пользователь увидит все "кишки" сайта**

## Учётные данные 
Логин\Пароль от аккаунта суперпользователя в django: admin\sn0wball. Зайти
в админовскую панель можно по адресу <app-site>/admin.

Для участников логин-пароль для входа совпадает с учётными данными ejudge, из
под которого они пишут контест. Никакой дополнительной регистрации не требуется.
